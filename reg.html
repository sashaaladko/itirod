<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Photo Gallery</title>
    <link rel="stylesheet" href="logandreg.css">
    <link rel="stylesheet" href="headerfooter.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
</head>

<body>
    <header class="header">
        <a class="logo" href="index.html"><img src="img/logo2.png"></a>
        <ul>
            <li><a class="login" href="log.html">Log in</a></li>
            <li><a class="signup" href="reg.html">Sign up</a></li>
        </ul>
    </header>

    <main>
        <div class="register-form-container">
            <form action="">
                <h1 class="form-title"> Registration</h1>
                <div class="form-fields">
                        <input id="userinp" class="form-field" type="text" placeholder="Username" required pattern="[a-zA-Z]+">
                        <input id="emailinp" class="form-field" type="email" placeholder="e-mail" >
                        <input id="passinp" class="form-field" type="password" placeholder="Password" required minlength="8" maxlength="128">
                </div>
                <div class="form-buttons">
                    <button id="regbtn" class="button">Register</button>
                </div>
             </form>
        </div>
    </main>

    <footer>
        <div class="socials">
            <a target="_blank" href="https://instagram.com/lohushkam_mimo">
                <img class="socials" src="img/instagram1.gif" title="instagram: lohushkam_mimo">
            </a>
        </div>
            <p class="copyryght">
                Copyright 2022 - All Rights Resetved
            </p>

    </footer>
</body>

<script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.8.1/firebase-app.js";
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyAbGwXsN1z8Vwi7UuvRO72aLegK75-FMmE",
    authDomain: "photo-gallery-d586f.firebaseapp.com",
    databaseURL: "https://photo-gallery-d586f-default-rtdb.firebaseio.com",
    projectId: "photo-gallery-d586f",
    storageBucket: "photo-gallery-d586f.appspot.com",
    messagingSenderId: "1009388373140",
    appId: "1:1009388373140:web:3e718d051ee7ae48eb2081"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);

    import { getDatabase, ref, set, child, get } from "https://www.gstatic.com/firebasejs/9.8.1/firebase-database.js";

    const db = getDatabase();

    const username = document.getElementById('userinp');
    const email = document.getElementById('emailinp');
    const pass = document.getElementById('passinp');
    const submit = document.getElementById('regbtn');
    
 
    function RegisterUser(){
        
        const dbRef = ref(db);
        get(child(dbRef, "UsersList/" + username.value)).then((snapshot)=>{
            if(snapshot.exists()){
                alert("Account alredy exist");
            }
            else{
                set(ref(db,"UsersList/" + username.value),{
                    email: email.value,
                    username: username.value,
                    password: pass.value
                })
                .then(()=>{
                    alert("user added successfully");
                })
                .catch((error)=>{
                    alert("error"+error);
                })
            }
        });
    }


    submit.addEventListener('click', RegisterUser);

</script>
</html>
